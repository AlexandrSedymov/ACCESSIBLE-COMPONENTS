import React, { useState } from 'react';
import * as Dialog from '@library-ui/react-dialog';

export const LibraryModal: React.FC = () => {
  const [isOpen, setIsOpen] = useState(false);
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    message: ''
  });

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    // Handle form submission
    setTimeout(() => {
      setIsOpen(false);
      setFormData({ name: '', email: '', message: '' });
      alert('Form submitted successfully!');
    }, 500);
  };

  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
  };

  return (
    <Dialog.Root open={isOpen} onOpenChange={setIsOpen}>
      <Dialog.Trigger asChild>
        <button className="library-modal-trigger">
          Open Contact Form
        </button>
      </Dialog.Trigger>
      
      <Dialog.Portal>
        <Dialog.Overlay className="library-modal-overlay" />
        <Dialog.Content className="library-modal-content">
          <Dialog.Title className="library-modal-title">
            Contact Us
          </Dialog.Title>
          <Dialog.Description className="library-modal-description">
            Send us a message and we'll get back to you as soon as possible.
          </Dialog.Description>

          <form onSubmit={handleSubmit}>
            <div className="library-form-field">
              <label htmlFor="contact-name">Name *</label>
              <input
                id="contact-name"
                name="name"
                type="text"
                required
                value={formData.name}
                onChange={handleInputChange}
                placeholder="Enter your full name"
              />
            </div>

            <div className="library-form-field">
              <label htmlFor="contact-email">Email *</label>
              <input
                id="contact-email"
                name="email"
                type="email"
                required
                value={formData.email}
                onChange={handleInputChange}
                placeholder="Enter your email address"
              />
            </div>

            <div className="library-form-field">
              <label htmlFor="contact-message">Message *</label>
              <textarea
                id="contact-message"
                name="message"
                required
                rows={4}
                value={formData.message}
                onChange={handleInputChange}
                placeholder="Enter your message"
              />
            </div>

            <div className="library-modal-actions">
              <Dialog.Close asChild>
                <button type="button">Cancel</button>
              </Dialog.Close>
              <button type="submit">Send Message</button>
            </div>
          </form>

          <Dialog.Close asChild>
            <button aria-label="Close dialog">×</button>
          </Dialog.Close>
        </Dialog.Content>
      </Dialog.Portal>
    </Dialog.Root>
  );
};

// Key Features:
// ✅ Open-source UI library integration (Radix UI Dialog)
// ✅ Controlled state management with React hooks  
// ✅ Portal-based rendering for proper z-index handling
// ✅ Built-in focus trapping and restoration
// ✅ ESC key and overlay click handling
// ✅ ARIA attributes automatically applied
// ✅ Form integration with validation
// ✅ Custom styling with CSS classes